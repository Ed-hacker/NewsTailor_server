================================================================================
                           TNP 프로젝트 API 명세서
================================================================================

1. 기본 정보
   - Base URL: http://localhost:8080
   - Content-Type: application/json
   - 인증 방식: JWT Bearer Token (일부 API)

================================================================================
                              기존 뉴스 API
================================================================================

1. 개인화된 뉴스 목록 조회
   GET /api/news
   
   Headers:
   - Authorization: Bearer {JWT_TOKEN}
   
   Query Parameters:
   - page: 페이지 번호 (기본값: 0)
   - size: 페이지 크기 (기본값: 10)
   
   Response:
   {
     "content": [
       {
         "id": 1,
         "title": "뉴스 제목",
         "category": "카테고리",
         "publishedAt": "2025-07-29T15:00:00"
       }
     ],
     "pageable": {
       "pageNumber": 0,
       "pageSize": 10
     },
     "totalElements": 100,
     "totalPages": 10
   }

2. 뉴스 상세 조회
   GET /api/news/{id}
   
   Headers:
   - Authorization: Bearer {JWT_TOKEN}
   
   Response:
   {
     "id": 1,
     "title": "뉴스 제목",
     "url": "뉴스 URL",
     "content": "뉴스 본문 내용",
     "category": "카테고리",
     "publishedAt": "2025-07-29T15:00:00",
     "summaryContent": "요약 내용",
     "isLiked": true,
     "isBookmarked": false,
     "likeCount": 25
   }


3. 뉴스 좋아요
   POST /api/news/{id}/like
   
   Headers:
   - Authorization: Bearer {JWT_TOKEN}
   
   Response: 200 OK

4. 뉴스 좋아요 취소
   DELETE /api/news/{id}/like
   
   Headers:
   - Authorization: Bearer {JWT_TOKEN}
   
   Response: 200 OK

5. 뉴스 북마크
   POST /api/news/{id}/bookmark
   
   Headers:
   - Authorization: Bearer {JWT_TOKEN}
   
   Response: 200 OK

6. 뉴스 북마크 취소
   DELETE /api/news/{id}/bookmark
   
   Headers:
   - Authorization: Bearer {JWT_TOKEN}
   
   Response: 200 OK

================================================================================
                           네이버 뉴스 랭킹 API
================================================================================

1. 섹션별 뉴스 랭킹 조회
   GET /api/v1/news/ranking
   
   Query Parameters:
   - sectionId: 섹션 ID (필수)
     * 100: 정치
     * 101: 경제
     * 102: 사회
     * 103: 생활/문화
     * 104: 세계
     * 105: IT/과학
   - date: 날짜 (YYYYMMDD 형식, 필수)
   
   Example: GET /api/v1/news/ranking?sectionId=105&date=20250729
   
   Response:
   [
     {
       "id": 1,
       "sectionId": 105,
       "press": "조선일보",
       "rank": 1,
       "title": "AI 기술 발전의 새로운 전환점",
       "url": "https://news.naver.com/main/read.naver?mode=LSD&mid=shm&sid1=105&oid=023&aid=0003826123",
       "body": "인공지능(AI) 기술이 새로운 전환점을 맞고 있다. 최근 발표된 연구에 따르면...",
       "collectedAt": "2025-07-29T14:05:00"
     },
     {
       "id": 2,
       "sectionId": 105,
       "press": "중앙일보",
       "rank": 2,
       "title": "메타버스 플랫폼 사용자 급증",
       "url": "https://news.naver.com/main/read.naver?mode=LSD&mid=shm&sid1=105&oid=025&aid=0003426789",
       "body": "국내 메타버스 플랫폼 이용자가 전년 대비 150% 증가한 것으로 나타났다...",
       "collectedAt": "2025-07-29T14:05:00"
     }
   ]

2. 최근 1위 뉴스 조회
   GET /api/v1/news/ranking/top
   
   Query Parameters:
   - limit: 조회할 기사 수 (기본값: 20, 최대 100)
   
   Example: GET /api/v1/news/ranking/top?limit=5
   
   Response:
   [
     {
       "id": 5,
       "sectionId": 100,
       "press": "연합뉴스",
       "rank": 1,
       "title": "국정감사 주요 이슈 분석",
       "url": "https://news.naver.com/main/read.naver?mode=LSD&mid=shm&sid1=100&oid=001&aid=0014826456",
       "body": "올해 국정감사에서 제기된 주요 이슈들을 분석해보면...",
       "collectedAt": "2025-07-29T13:05:00"
     }
   ]

3. 특정 기사 본문 조회
   GET /api/v1/news/ranking/{id}/content
   
   Response:
   {
     "id": 1,
     "title": "AI 기술 발전의 새로운 전환점",
     "url": "https://news.naver.com/main/read.naver?mode=LSD&mid=shm&sid1=105&oid=023&aid=0003826123",
     "body": "인공지능(AI) 기술이 새로운 전환점을 맞고 있다. 최근 발표된 연구에 따르면 대화형 AI의 성능이 이전보다 대폭 향상되었으며, 이는 다양한 산업 분야에 혁신적인 변화를 가져올 것으로 예상된다고 전문가들은 분석했다..."
   }

================================================================================
                              인증 API
================================================================================

1. 회원가입
   POST /api/signup
   
   Request Body:
   {
     "username": "testuser",
     "password": "password123!",
     "nickname": "홍길동",
     "interestIds": [1, 2, 3]
   }
   
   Validation Rules:
   - username: 4~20자, 필수
   - password: 8~20자, 영문+숫자+특수문자 각 1개 이상, 필수
   - nickname: 2~10자, 필수
   - interestIds: 관심사 ID 배열, 선택사항
   
   Response:
   201 Created
   "회원가입 성공"

2. 로그인
   POST /api/login
   
   Request Body:
   {
     "username": "testuser",
     "password": "password123!"
   }
   
   Response:
   {
     "accessToken": "eyJhbGciOiJIUzI1NiJ9...",
     "username": "testuser"
   }

3. 아이디 중복 체크
   GET /api/auth/check-username?username={username}
   
   Query Parameters:
   - username: 체크할 사용자명 (4~20자)
   
   Response:
   {
     "available": true,
     "message": "사용 가능한 아이디입니다."
   }
   
   또는
   
   {
     "available": false,
     "message": "이미 사용 중인 아이디입니다."
   }

================================================================================
                              관심사 API
================================================================================

1. 사용 가능한 관심사 목록 조회
   GET /api/interests
   
   Response:
   [
     {
       "id": 1,
       "name": "기술"
     },
     {
       "id": 2,
       "name": "경제"
     }
   ]

2. 사용자 관심사 설정
   POST /api/user/interests
   
   Headers:
   - Authorization: Bearer {JWT_TOKEN}
   
   Request Body:
   {
     "interestIds": [1, 2, 3]
   }
   
   Response: 200 OK

================================================================================
                           에러 응답 형식
================================================================================

HTTP Status Code와 함께 다음 형식의 에러 응답이 반환됩니다:

{
  "timestamp": "2025-07-29T15:30:00.123+09:00",
  "status": 404,
  "error": "Not Found",
  "message": "뉴스를 찾을 수 없습니다: 999",
  "path": "/api/news/999"
}

주요 에러 코드:
- 400 Bad Request: 잘못된 요청 파라미터, Validation 오류
  * 예시: "아이디는 4~20자 사이여야 합니다., 비밀번호는 영문, 숫자, 특수문자를 각각 최소 1개씩 포함해야 합니다."
- 401 Unauthorized: 인증 토큰이 없거나 유효하지 않음
- 403 Forbidden: 권한 부족
- 404 Not Found: 리소스를 찾을 수 없음
- 500 Internal Server Error: 서버 내부 오류

Validation 에러 응답 예시:
{
  "status": 400,
  "message": "비밀번호는 8~20자 사이여야 합니다., 비밀번호는 영문, 숫자, 특수문자를 각각 최소 1개씩 포함해야 합니다."
}

================================================================================
                            크롤링 스케줄
================================================================================

네이버 뉴스 랭킹 크롤링:
- 실행 주기: 매 정시 5분마다 (예: 09:05, 10:05, 11:05...)
- 크롤링 대상: 모든 섹션 (정치, 경제, 사회, 생활/문화, 세계, IT/과학)
- 중복 방지: URL 기준으로 중복 기사 저장 방지
- 본문 크롤링: 각 기사별 본문 내용 수집
- 지연 처리: 기사별 1초 지연으로 서버 부하 방지

================================================================================
                            데이터베이스
================================================================================

주요 테이블:
1. users: 사용자 정보 (username, password, nickname)
2. news: 기존 뉴스 데이터
3. news_rankings: 네이버 뉴스 랭킹 데이터 (신규)
4. interests: 관심사 정보
5. user_interest: 사용자-관심사 연결
6. article_like: 뉴스 좋아요
7. bookmark: 뉴스 북마크
8. summary: 뉴스 요약 (OpenAI GPT 연동)

변경사항:
- users 테이블에서 email 필드 완전 제거
- 사용자 식별은 username으로만 처리
- 회원가입 시 관심사 동시 설정 가능
- TTS 관련 테이블 및 API 제거 (프론트엔드에서 구현)

================================================================================